group_by(SITE, TREAT, PLOT, DIV, SPP) %>%
count(.drop = F)
# summing according to species
spp_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, DIV, SPP, .drop = F)) %>%
# summing according to species
spp_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, DIV, SPP, .drop = F) %>%
count()
# summing according to species
spp_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, DIV, SPP) %>%
add_count()
# summing according to species
spp_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, DIV, SPP) %>%
tally()
# summing according to species
spp_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, DIV, SPP, .drop = F) %>%
tally()
# summing according to species
spp_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, DIV) %>%
count(SPP)
# summing according to species
spp_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, DIV) %>%
summarise(COUNT_unscale = n()) %>%
ungroup() %>%
complete(SPP, nesting(SITE, TREAT, PLOT, DIV), fill = list(COUNT_unscale = 0))
# summing according to species
spp_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, DIV, SPP) %>%
summarise(COUNT_unscale = n()) %>%
ungroup() %>%
complete(SPP, nesting(SITE, TREAT, PLOT, DIV), fill = list(COUNT_unscale = 0))
# summing according to species
spp_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, DIV, SPP) %>%
summarise(COUNT_unscale = n()) %>%
complete(SPP, nesting(SITE, TREAT, PLOT, DIV), fill = list(COUNT_unscale = 0))
# summing according to species
spp_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, DIV, SPP) %>%
summarise(COUNT_unscale = n()) %>%
complete(SPP, nesting(SITE, TREAT, PLOT, DIV), fill = list(COUNT_unscale = 0))
# summing according to species
dbh_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, DIV) %>%
count(SPP, .drop = F)
View(dbh_dens)
# summing according to species
dbh_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, DIV, SPP) %>%
add_count()
# summing according to species
dbh_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, DIV) %>%
count(SPP)
# summing according to species
dbh_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, DIV, SPP) %>%
tally(SPP)
class(dbh$DIV)
class(dbh$PLOT)
class(dbh$SPP)
class(dbh$TREAT)
class(dbh$SITE)
dbh$TREAT <- as.factor(dbh$TREAT)
# summing according to species
dbh_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, DIV, SPP) %>%
tally(SPP)
# summing according to species
dbh_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, DIV, SPP) %>%
count(SPP)
# summing according to species
dbh_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, DIV, SPP) %>%
count(SPP, .drop = F)
# summing according to species
dbh_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, DIV, SPP) %>%
summarise(COUNT = n())
# summing according to species
dbh_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, DIV, SPP) %>%
summarise(COUNT = n()) %>%
complete(SPP, fill = list(COUNT = 0))
# summing according to species
dbh_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, DIV, SPP) %>%
summarise(COUNT = n()) %>%
ungroup() %>%
complete(SITE, TREAT, PLOT, DIV, SPP, fill = list(COUNT = 0))
# summing according to species
dbh_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, SPP) %>%
summarise(COUNT = n()) %>%
ungroup() %>%
complete(SITE, TREAT, PLOT, SPP, fill = list(COUNT = 0))
# summing according to species
dbh_dens <- dbh %>%
group_by(SITE, PLOT, SPP) %>%
summarise(COUNT = n()) %>%
ungroup() %>%
complete(SITE, PLOT, SPP, fill = list(COUNT = 0))
library(tidyverse)
library(cowplot)
library(tidyverse)
library(cowplot)
library(here)
theme_set(theme_cowplot())
options(scipen = 9999)
se <- function(x) sqrt(var(x)/length(x))
dbh <- read.csv(here("data/dbh_raw.csv"))
# merging salix
dbh$SPP[dbh$SPP == "SAGL"] <- "SALIX"
dbh$SPP[dbh$SPP == "SA_3"] <- "SALIX"
dbh$SPP[dbh$SPP == "SA_4"] <- "SALIX"
dbh$SPP[dbh$SPP == "SA_5"] <- "SALIX"
dbh$SPP[dbh$SPP == "SA_6"] <- "SALIX"
dbh$SPP[dbh$SPP == "SA_7"] <- "SALIX"
dbh$SPP[dbh$SPP == "SA_8"] <- "SALIX"
dbh$SPP[dbh$SPP == "SA_?"] <- "SALIX"
dbh$SPP[dbh$SPP == "SADE"] <- "SALIX"
dbh$SPP[dbh$SPP == "SAPU"] <- "SALIX"
dbh$SPP[dbh$SPP == "SAGL_R"] <- "SALIX"
# dropping unknown
dbh <- dbh %>%
filter(SPP != "UNKNOWN")
# adding conifer and deciduous divisons
dbh$DIV[dbh$SPP == "PIME"] <- "c"
dbh$DIV[dbh$SPP == "BENE"] <- "d"
dbh$DIV[dbh$SPP == "POTR"] <- "d"
dbh$DIV[dbh$SPP == "POBA"] <- "d"
dbh$DIV[dbh$SPP == "SALIX"] <- "d"
dbh$DIV[dbh$SPP == "ARCTO"] <- "d"
dbh$DIV[dbh$SPP == "ALCR"] <- "d"
# adding expansion factors
# assuming a plot is 1/25 of a ha, so half a plot is 1/50 of a ha.
dbh$EXP_FACT[dbh$QUAD == 2] <- 50
dbh$EXP_FACT[dbh$QUAD == 1] <- 100
dbh$EXP_FACT[dbh$QUAD == .1] <- 1000
dbh$EXP_FACT[dbh$QUAD == .2] <- 500
write.csv(dbh, here("data/dbh.csv"), row.names = F)
dbh <- read.csv(here("data/dbh.csv"))
dbh$TREAT <- as.factor(dbh$TREAT)
# dropping dead trees
dbh <- dbh %>%
filter(CANOPY > 0)
# summing according to species
dbh_dens <- dbh %>%
group_by(SITE, PLOT, SPP) %>%
summarise(COUNT = n()) %>%
ungroup() %>%
complete(SITE, PLOT, SPP, fill = list(COUNT = 0))
# summing according to species
dbh_dens <- dbh %>%
group_by(PLOT, SPP) %>%
summarise(COUNT = n()) %>%
ungroup() %>%
complete( PLOT, SPP, fill = list(COUNT = 0))
# summing according to species
dbh_dens <- dbh %>%
group_by(SITE, PLOT, SPP) %>%
summarise(COUNT = n()) %>%
ungroup() %>%
complete(SITE, PLOT, SPP, fill = list(COUNT = 0))
# summing according to species
dbh_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, SPP) %>%
summarise(COUNT = n()) %>%
ungroup() %>%
complete(SITE, TREAT,  PLOT, SPP, fill = list(COUNT = 0))
# summing according to species
dbh_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, SPP) %>%
summarise(COUNT = n()) %>%
ungroup() %>%
group_by(SITE, TREAT,  PLOT) %>%
complete( SPP, fill = list(COUNT = 0))
# summing according to species
dbh_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, DIV, SPP) %>%
summarise(COUNT = n()) %>%
ungroup() %>%
group_by(SITE, TREAT,PLOT, DIV) %>%
complete( SPP, fill = list(COUNT = 0))
dbh_dens <- dbh %>%
group_by(SITE, TREAT, PLOT, SPP) %>%
summarise(COUNT = n()) %>%
ungroup() %>%
group_by(SITE, TREAT,PLOT) %>%
complete( SPP, fill = list(COUNT = 0))
# adding divisions back in
dens$DIV[dens$SPP == "PIME"] <- "c"
# summing according to species
dens <- dbh %>%
group_by(SITE, TREAT, PLOT, SPP) %>%
summarise(COUNT = n()) %>%
ungroup() %>%
group_by(SITE, TREAT,PLOT) %>%
complete( SPP, fill = list(COUNT = 0))
# summing according to species
dens <- dbh %>%
group_by(SITE, TREAT, PLOT, SPP) %>%
summarise(COUNT = n()) %>%
ungroup() %>%
group_by(SITE, TREAT,PLOT) %>%
complete( SPP, fill = list(COUNT = 0))
# adding divisions back in
dens$DIV[dens$SPP == "PIME"] <- "c"
dens$DIV[dens$SPP == "BENE"] <- "d"
dens$DIV[dens$SPP == "BENE"] <- "d"
dens$DIV[dens$SPP == "POTR"] <- "d"
dens$DIV[dens$SPP == "BENE"] <- "d"
dens$DIV[dens$SPP == "POTR"] <- "d"
dens$DIV[dens$SPP == "POBA"] <- "d"
dens$DIV[dens$SPP == "SALIX"] <- "d"
dens$DIV[dens$SPP == "ARCTO"] <- "d"
dens$DIV[dens$SPP == "ALCR"] <- "d"
View(dbh_dens)
View(dens)
test <- dbh %>%
group_by(SITE, TREAT, PLOT) %>%
slice(rep(1:n(EXP_FACT), each = 4))
test <- dbh %>%
group_by(SITE, TREAT, PLOT, EXP_FACT) %>%
slice(rep(1:n(), each = 4))
View(test)
test <- dbh %>%
select(SITE, TREAT, PLOT, EXP_FACT) %>%
slice(rep(1:n(), each = 4))
test <- dbh %>%
select(SITE, TREAT, PLOT, EXP_FACT) %>%
slice(rep(1:n()))
test <- dbh %>%
group_by(SITE, TREAT, PLOT,SPP) %>%
summarise(EXP_FACT1 = max(EXP_FACT))
test <- dbh %>%
group_by(SITE, TREAT, PLOT) %>%
summarise(EXP_FACT1 = max(EXP_FACT))
test <- dbh %>%
group_by(SITE, TREAT, PLOT) %>%
summarise(EXP_FACT1 = max(EXP_FACT)) %>%
slice(rep(1:n(), each = 7))
test <- dbh %>%
group_by(SITE, TREAT, PLOT) %>%
summarise(EXP_FACT = max(EXP_FACT)) %>%
slice(rep(1:n(), each = 7))
dens$EXP_FACT <- test$EXP_FACT
# summing according to species
dens <- dbh %>%
group_by(SITE, TREAT, PLOT, SPP) %>%
summarise(COUNT_PLOT = n()) %>%
ungroup() %>%
group_by(SITE, TREAT,PLOT) %>%
complete( SPP, fill = list(COUNT_PLOT = 0))
# adding divisions back in
dens$DIV[dens$SPP == "PIME"] <- "c"
dens$DIV[dens$SPP == "BENE"] <- "d"
dens$DIV[dens$SPP == "POTR"] <- "d"
dens$DIV[dens$SPP == "POBA"] <- "d"
dens$DIV[dens$SPP == "ARCTO"] <- "d"
dens$DIV[dens$SPP == "ALCR"] <- "d"
# adding expansion factor back
test <- dbh %>%
group_by(SITE, TREAT, PLOT) %>%
summarise(EXP_FACT = max(EXP_FACT)) %>%
slice(rep(1:n(), each = 7))
dens$EXP_FACT <- test$EXP_FACT
# scaling up
dens$COUNT_ha <- dens$COUNT_PLOT * dens$EXP_FACT
dens$DIV[dens$SPP == "SALIX"] <- "d"
library(tidyverse)
library(cowplot)
library(here)
theme_set(theme_cowplot())
options(scipen = 9999)
se <- function(x) sqrt(var(x)/length(x))
dbh <- read.csv(here("data/dbh.csv"))
dbh$TREAT <- as.factor(dbh$TREAT)
# dropping dead trees
dbh <- dbh %>%
filter(CANOPY > 0)
# summing according to species
dens <- dbh %>%
group_by(SITE, TREAT, PLOT, SPP) %>%
summarise(COUNT_PLOT = n()) %>%
ungroup() %>%
group_by(SITE, TREAT,PLOT) %>%
complete( SPP, fill = list(COUNT_PLOT = 0))
# adding divisions back in
dens$DIV[dens$SPP == "PIME"] <- "c"
dens$DIV[dens$SPP == "BENE"] <- "d"
dens$DIV[dens$SPP == "POTR"] <- "d"
dens$DIV[dens$SPP == "POBA"] <- "d"
dens$DIV[dens$SPP == "SALIX"] <- "d"
dens$DIV[dens$SPP == "ARCTO"] <- "d"
dens$DIV[dens$SPP == "ALCR"] <- "d"
# adding expansion factor back
test <- dbh %>%
group_by(SITE, TREAT, PLOT) %>%
summarise(EXP_FACT = max(EXP_FACT)) %>%
slice(rep(1:n(), each = 7))
dens$EXP_FACT <- test$EXP_FACT
# scaling up
dens$COUNT_ha <- dens$COUNT_PLOT * dens$EXP_FACT
View(dens)
library(tidyverse)
library(cowplot)
library(here)
theme_set(theme_cowplot())
options(scipen = 9999)
se <- function(x) sqrt(var(x)/length(x))
seed <- read.csv(here("data/seedling_count_raw.csv"))
View(seed)
seed$EXP_FACT[seed$M2 == 9] <- (10000/9)
seed$EXP_FACT[seed$M2 == 100] <- 100
seed$EXP_FACT[seed$M2 == 10] <- 1000
seed$EXP_FACT[seed$M2 == 20] <- 500
# scaling up
seed$COUNT_ha <- seed$EXP_FACT * seed$TOTAL_COUNT
dbh <- read.csv(here("data/dbh.csv"))
View(dbh)
dbh$TREAT <- as.factor(dbh$TREAT)
# dropping dead trees
dbh <- dbh %>%
filter(CANOPY > 0)
# summing according to species
dens <- dbh %>%
group_by(SITE, TREAT, PLOT, SPP) %>%
summarise(COUNT_PLOT = n()) %>%
ungroup() %>%
group_by(SITE, TREAT,PLOT) %>%
complete( SPP, fill = list(COUNT_PLOT = 0))
# adding divisions back in
dens$DIV[dens$SPP == "PIME"] <- "c"
dens$DIV[dens$SPP == "BENE"] <- "d"
dens$DIV[dens$SPP == "POTR"] <- "d"
dens$DIV[dens$SPP == "POBA"] <- "d"
dens$DIV[dens$SPP == "SALIX"] <- "d"
dens$DIV[dens$SPP == "ARCTO"] <- "d"
dens$DIV[dens$SPP == "ALCR"] <- "d"
# adding expansion factor back
test <- dbh %>%
group_by(SITE, TREAT, PLOT) %>%
summarise(EXP_FACT = max(EXP_FACT)) %>%
slice(rep(1:n(), each = 7))
dens$EXP_FACT <- test$EXP_FACT
# scaling up
dens$COUNT_ha <- dens$COUNT_PLOT * dens$EXP_FACT
View(dens)
# combining seedling and dbh
seed <- seed[seed$SPP != "POBA",]
seed <- read.csv(here("data/seedling_count_raw.csv"))
# adding expansion factors
seed$EXP_FACT[seed$M2 == 100] <- 100
seed$EXP_FACT[seed$M2 == 10] <- 1000
seed$EXP_FACT[seed$M2 == 20] <- 500
seed$EXP_FACT[seed$M2 == 9] <- (10000/9)
# scaling up
seed$COUNT_ha <- seed$EXP_FACT * seed$TOTAL_COUNT
seed %>%
arrange(match(SPP, c("ALCR", "ARCTO", "BENE", "POBA", "POTR", "SALIX", "PIGL", "PIME")))
seed %>%
group_by(SITE, TREAT, PLOT) %>%
arrange(match(SPP, c("ALCR", "ARCTO", "BENE", "POBA", "POTR", "SALIX", "PIGL", "PIME")))
View(dbh)
View(dens)
seed %>%
group_by(SITE, TREAT, PLOT) %>%
arrange(match(SPP, c("ALCR", "ARCTO", "BENE", "POBA", "POTR", "SALIX", "PIGL", "PIME")))
seed %>%
group_by(SITE, TREAT, PLOT) %>%
arrange(match(SPP, c("ALCR", "ARCTO", "BENE", "POBA", "POTR", "SALIX", "PIGL", "PIME")),
.by_group = T)
test <- seed %>%
group_by(SITE, TREAT, PLOT) %>%
arrange(match(SPP, c("ALCR", "ARCTO", "BENE", "POBA", "POTR", "SALIX", "PIGL", "PIME")),
.by_group = T)
View(test)
seed %>%
filter(SPP == "PIGL") %>%
filter(COUNT_ha >0)
# creating PIGL rows
test <- dens %>%
select(SITE, TREAT, PLOT, EXP_FACT)
# creating PIGL rows
test <- dens %>%
select(SITE, TREAT, PLOT, EXP_FACT) %>%
distinct()
test$SPP <- "PIGL"
test <- dens %>%
select(SITE, TREAT, PLOT, EXP_FACT) %>%
distinct()
test$SPP <- "PIGL"
test$COUNT_ha <- 0
test$COUNT_PLOT <- 0
test$DIV <- "c"
temp <- rbind(test, dens)
View(temp)
temp <- rbind(dens, test
temp <- rbind(dens, test)
test <- dens %>%
select(SITE, TREAT, PLOT, EXP_FACT) %>%
distinct()
test$SPP <- as.factor("PIGL")
test$COUNT_ha <- 0
test$COUNT_PLOT <- 0
test$DIV <- as.factor("c")
temp <- rbind(dens, test)
View(temp)
class(temp$SITE)
# creating PIGL rows
test <- dens %>%
select(SITE, TREAT, PLOT, EXP_FACT) %>%
distinct()
test$SPP <- as.factor("PIGL")
test$COUNT_ha <- 0
test$COUNT_PLOT <- 0
test$DIV <- as.factor("c")
temp <- rbind(dens, test)
dens$DIV <- as.factor(dens$DIV)
temp <- rbind(dens, test)
test$DIV <- as.factor("c")
temp <- rbind(dens, test)
test2 <- merge(temp, seed)
View(test2)
dens <- rbind(dens, test)
dens1 <- dens %>%
group_by(SITE, TREAT, PLOT) %>%
arrange(match(SPP, c("ALCR", "ARCTO", "BENE", "POBA", "POTR", "SALIX", "PIGL", "PIME")),
.by_group = T)
View(dens1)
test <- seed %>%
group_by(SITE, TREAT, PLOT) %>%
arrange(match(SPP, c("ALCR", "ARCTO", "BENE", "POBA", "POTR", "SALIX", "PIGL", "PIME")),
.by_group = T)
dens <- dens %>%
group_by(SITE, TREAT, PLOT) %>%
arrange(match(SPP, c("ALCR", "ARCTO", "BENE", "POBA", "POTR", "SALIX", "PIGL", "PIME")),
.by_group = T)
View(dens)
dens <- dens %>%
group_by(SITE, TREAT, PLOT) %>%
arrange(match(SPP, c("ALCR", "ARCTO", "BENE", "POBA", "POTR", "SALIX", "PIGL", "PIME")),
.by_group = T) %>%
rename(TREE_COUNT_PLOT = COUNT_PLOT, TREE_COUNT_HA = COUNT_ha)
seed <- seed %>%
group_by(SITE, TREAT, PLOT) %>%
arrange(match(SPP, c("ALCR", "ARCTO", "BENE", "POBA", "POTR", "SALIX", "PIGL", "PIME")),
.by_group = T)
dens$SEED_COUNT_PLOT <- seed$TOTAL_COUNT
seed <- read.csv(here("data/seedling_count_raw.csv"))
# adding expansion factors
seed$EXP_FACT[seed$M2 == 100] <- 100
seed$EXP_FACT[seed$M2 == 10] <- 1000
seed$EXP_FACT[seed$M2 == 20] <- 500
seed$EXP_FACT[seed$M2 == 9] <- (10000/9)
# scaling up
seed$COUNT_ha <- seed$EXP_FACT * seed$TOTAL_COUNT
# combining seedling and dbh
seed <- seed %>%
group_by(SITE, TREAT, PLOT) %>%
arrange(match(SPP, c("ALCR", "ARCTO", "BENE", "POBA", "POTR", "SALIX", "PIGL", "PIME")),
.by_group = T)
dens <- dens %>%
group_by(SITE, TREAT, PLOT) %>%
arrange(match(SPP, c("ALCR", "ARCTO", "BENE", "POBA", "POTR", "SALIX", "PIGL", "PIME")),
.by_group = T) %>%
rename(TREE_COUNT_PLOT = COUNT_PLOT, TREE_COUNT_HA = COUNT_ha)
dens$SEED_COUNT_PLOT <- seed$TOTAL_COUNT
View(seed)
seed$PLOT
unique(seed$PLOT)
unique(dens$PLOT)
unique(dens$SPP)
unique(seed$SPP)
seed <- read.csv(here("data/seedling_count_raw.csv"))
# adding expansion factors
seed$EXP_FACT[seed$M2 == 100] <- 100
seed$EXP_FACT[seed$M2 == 10] <- 1000
seed$EXP_FACT[seed$M2 == 20] <- 500
seed$EXP_FACT[seed$M2 == 9] <- (10000/9)
# scaling up
seed$COUNT_ha <- seed$EXP_FACT * seed$TOTAL_COUNT
# combining seedling and dbh
seed <- seed %>%
group_by(SITE, TREAT, PLOT) %>%
arrange(match(SPP, c("ALCR", "ARCTO", "BENE", "POBA", "POTR", "SALIX", "PIGL", "PIME")),
.by_group = T)
dens$SEED_COUNT_PLOT <- seed$TOTAL_COUNT
unique(seed$SPP)
length(seed$SITE == "STEESE")
length(dens$SITE == "STEESE")
unique(seed$SITE == "STEESE")
unique(seed$PLOT[seed$SITE == "STEESE"])
unique(dens$PLOT[dens$SITE == "STEESE"])
install.packages("arsenal")
install.packages("arsenal")
install.packages("arsenal")
install.packages("arsenal")
install.packages("arsenal")
install.packages("arsenal")
install.packages("arsenal")
install.packages("arsenal")
install.packages("arsenal")
install.packages("arsenal")
