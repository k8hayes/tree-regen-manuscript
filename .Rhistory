#now predict new data, but the response, which will back transform
preddata <- data.frame(group=unique(CONIF_dens$PLOT))
preds <- predict(mC_D.nb, newdata=preddata, type="response", se.fit=T)
#note the evidence it's back transformed proper
preds$fit; ss$mean
#note the evidence it's back transformed proper
preds$fit
preds <- predict(mC_D.nb, newdata=preddata, type="response", se.fit=T)
#now predict new data, but the response, which will back transform
preddata <- data.frame(PLOT=unique(CONIF_dens$PLOT))
preds <- predict(mC_D.nb, newdata=preddata, type="response", se.fit=T)
#now predict new data, but the response, which will back transform
preddata <- data.frame(PLOT=unique(CONIF_dens$PLOT))
preds<- predict(mC_D.nb, newdata=preddata, type="response", se.fit=T)
#now predict new data, but the response, which will back transform
preddata <- data.frame(TREAT = unique(CONIF_dens$TREAT))
preds<- predict(mC_D.nb, newdata=preddata, type="response", se.fit=T)
# unburned graphs
library(tidyverse)
library(ggplot2)
library(cowplot)
library(here)
theme_set(theme_cowplot())
options(scipen = 9999)
ba <- read.csv(here("ba.csv"))
dens <- read.csv(here("data/density.csv"))
plot_dens <- dens %>%
group_by(SITE, TREAT, PLOT, DIV) %>%
summarise(COUNT_HA = mean(COUNT_HA))
ba <- read.csv(here("ba.csv"))
ba <- read.csv(here("data/ba.csv"))
dens <- read.csv(here("data/density.csv"))
plot_dens <- dens %>%
group_by(SITE, TREAT, PLOT, DIV) %>%
summarise(COUNT_HA = mean(COUNT_HA))
# density plot
conif_dens <- plot_dens %>%
filter(TREAT == 0) %>%
filter(DIV == "c") %>%
ggplot(aes(x = as.factor(SITE), y = COUNT_HA)) + geom_boxplot() +
labs(x = " ",y = "Conifer Density", title = "Unburned Density (stem/ha)") +
theme(plot.title = element_text(hjust = 0)) +
scale_x_discrete(labels = c("Upland", "Lowland"))
# DECID density
decid_dens <- plot_dens %>%
filter(TREAT == 0) %>%
filter(DIV == "d") %>%
ggplot(aes(x = as.factor(SITE), y = COUNT_HA)) + geom_boxplot() +
labs(x = "",y = "Decid. Density", title = "")  +
scale_x_discrete(labels = c("Upland", "Lowland"))
density <- cowplot::plot_grid(conif_dens, decid_dens)
density
cconif_dens
conif_dens
# density plot
conif_dens <- plot_dens %>%
filter(TREAT == 0) %>%
filter(DIV == "c") %>%
ggplot(aes(x = as.factor(SITE), y = COUNT_HA)) + geom_boxplot() +
labs(x = " ",y = "Density (stem/ha)", title = "Conifer Density") +
theme(plot.title = element_text(hjust = 0)) +
scale_x_discrete(labels = c("Upland", "Lowland"))
# DECID density
decid_dens <- plot_dens %>%
filter(TREAT == 0) %>%
filter(DIV == "d") %>%
ggplot(aes(x = as.factor(SITE), y = COUNT_HA)) + geom_boxplot() +
labs(x = "",y = "Density (stem/ha)", title = "Deciduous Density")  +
scale_x_discrete(labels = c("Upland", "Lowland"))
density <- cowplot::plot_grid(conif_dens, decid_dens)
density
# basal area
plot_ba <- ba %>%
group_by(SITE, TREAT, PLOT, DIV) %>%
summarise(BA_ha = mean(BA_ha))
# CONIF basal area
conif_ba <- plot_ba %>%
filter(TREAT == 0) %>%
filter(DIV == "c") %>%
ggplot(aes(x = as.factor(SITE), y = BA_ha)) + geom_boxplot() +
labs(x = " ",y = "Basal Area (m2/ha)", title = "Conifer Basal Area")   +
theme(plot.title = element_text(hjust = 0)) +
scale_x_discrete(labels = c("Upland", "Lowland"))
# DECID basal area
decid_ba <-plot_ba %>%
filter(TREAT == 0) %>%
filter(DIV == "d") %>%
ggplot(aes(x = as.factor(SITE), y = BA_ha)) + geom_boxplot() +
labs(x = "",y = "Basal Area (m2/ha)", title = "Deciduous Basal Aresa")   +
scale_x_discrete(labels = c("Upland", "Lowland"))
ba <- cowplot:: plot_grid(conif_ba, decid_ba, ncol = 2)
# rm(conif_ba, decid_ba)
ba
lrow <- cowplot:: plot_grid(conif_dens, conif_ba, align = "v", axis = 'l', ncol = 1)
rrow <- cowplot:: plot_grid(decid_dens, decid_ba, align = "v", axis = "l", ncol = 1)
plot <- cowplot:: plot_grid(lrow, rrow, ncol = 2)
plot
fig3 <- cowplot:: plot_grid(lrow, rrow, ncol = 2)
fig3
"Unburned stand structure across site",
fontface = 'bold',
x = 0, hjust = 0) +
theme(plot.margin = margin(0,0,0,7))
"Unburned stand structure across site",
fontface = 'bold',
x = 0, hjust = 0) +
theme(plot.margin = margin(0,0,0,7))
fig3 + ggdraw() +
draw_label(
"Unburned stand structure across site",
fontface = 'bold',
x = 0, hjust = 0) +
theme(plot.margin = margin(0,0,0,7))
"Unburned stand structure across site",
fontface = 'bold',
x = 0, hjust = 0) +
theme(plot.margin = margin(0,0,0,7))
plot_grid(title, lrow, rrow, ncol = 2)
fig3
title <- ggdraw() +
draw_label(
"Miles per gallon decline with displacement and horsepower",
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7)
)
plot_grid(
title, fig3,
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1)
)
title <- ggdraw() +
draw_label(
"Unburned Stand Structure between an Upland and Lowland Site",
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7)
)
plot_grid(
title, fig3,
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1)
)
title <- ggdraw() +
draw_label(
"Unburned Stand Structure between an Upland and Lowland Site",
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 14)
)
plot_grid(
title, fig3,
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1)
)
title <- ggdraw() +
draw_label(
"Unburned Stand Structure between an Upland and Lowland Site",
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 20)
)
plot_grid(
title, fig3,
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1)
)
# DECID basal area
decid_ba <-plot_ba %>%
filter(TREAT == 0) %>%
filter(DIV == "d") %>%
ggplot(aes(x = as.factor(SITE), y = BA_ha)) + geom_boxplot() +
labs(x = "",y = "Basal Area (m2/ha)", title = "Deciduous Basal Aresa")   +
scale_x_discrete(labels = c("Upland", "Lowland")) +
theme(plot.title = element_text(size=22))
ba <- cowplot:: plot_grid(conif_ba, decid_ba, ncol = 2)
# rm(conif_ba, decid_ba)
ba
# DECID basal area
decid_ba <-plot_ba %>%
filter(TREAT == 0) %>%
filter(DIV == "d") %>%
ggplot(aes(x = as.factor(SITE), y = BA_ha)) + geom_boxplot() +
labs(x = "",y = "Basal Area (m2/ha)", title = "Deciduous Basal Aresa")   +
scale_x_discrete(labels = c("Upland", "Lowland")) +
theme(plot.title = element_text(size= 16))
ba <- cowplot:: plot_grid(conif_ba, decid_ba, ncol = 2)
# rm(conif_ba, decid_ba)
ba
# DECID basal area
decid_ba <-plot_ba %>%
filter(TREAT == 0) %>%
filter(DIV == "d") %>%
ggplot(aes(x = as.factor(SITE), y = BA_ha)) + geom_boxplot() +
labs(x = "",y = "Basal Area (m2/ha)", title = "Deciduous Basal Aresa")   +
scale_x_discrete(labels = c("Upland", "Lowland")) +
theme(plot.title = element_text(size = 12))
ba <- cowplot:: plot_grid(conif_ba, decid_ba, ncol = 2)
# rm(conif_ba, decid_ba)
ba
# density plot
conif_dens <- plot_dens %>%
filter(TREAT == 0) %>%
filter(DIV == "c") %>%
ggplot(aes(x = as.factor(SITE), y = COUNT_HA)) + geom_boxplot() +
labs(x = " ",y = "Density (stem/ha)", title = "Conifer Density") +
theme(plot.title = element_text(hjust = 0)) +
scale_x_discrete(labels = c("Upland", "Lowland")) +
theme(plot.title = element_text(size = 12))
# DECID density
decid_dens <- plot_dens %>%
filter(TREAT == 0) %>%
filter(DIV == "d") %>%
ggplot(aes(x = as.factor(SITE), y = COUNT_HA)) + geom_boxplot() +
labs(x = "",y = "Density (stem/ha)", title = "Deciduous Density")  +
scale_x_discrete(labels = c("Upland", "Lowland")) +
theme(plot.title = element_text(size = 12))
density <- cowplot::plot_grid(conif_dens, decid_dens)
density
# basal area
plot_ba <- ba %>%
group_by(SITE, TREAT, PLOT, DIV) %>%
summarise(BA_ha = mean(BA_ha))
# CONIF basal area
conif_ba <- plot_ba %>%
filter(TREAT == 0) %>%
filter(DIV == "c") %>%
ggplot(aes(x = as.factor(SITE), y = BA_ha)) + geom_boxplot() +
labs(x = " ",y = "Basal Area (m2/ha)", title = "Conifer Basal Area")   +
theme(plot.title = element_text(hjust = 0)) +
scale_x_discrete(labels = c("Upland", "Lowland")) +
theme(plot.title = element_text(size = 12))
# DECID basal area
decid_ba <-plot_ba %>%
filter(TREAT == 0) %>%
filter(DIV == "d") %>%
ggplot(aes(x = as.factor(SITE), y = BA_ha)) + geom_boxplot() +
labs(x = "",y = "Basal Area (m2/ha)", title = "Deciduous Basal Aresa")   +
scale_x_discrete(labels = c("Upland", "Lowland")) +
theme(plot.title = element_text(size = 12))
ba <- cowplot:: plot_grid(conif_ba, decid_ba, ncol = 2)
# rm(conif_ba, decid_ba)
ba
lrow <- cowplot:: plot_grid(conif_dens, conif_ba, align = "v", axis = 'l', ncol = 1)
rrow <- cowplot:: plot_grid(decid_dens, decid_ba, align = "v", axis = "l", ncol = 1)
fig3 <- cowplot:: plot_grid(lrow, rrow, ncol = 2)
plot_grid(
title, fig3,
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1)
)
"Unburned Stand Structure between an Upland and Lowland Site",
fontface = 'bold',
x = 0,
hjust = 0) +
theme(plot.title = element_text(size = 18),
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 20))
plot_grid(title, fig3,
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1))
title <- ggdraw() +
draw_label(
"Unburned Stand Structure between an Upland and Lowland Site",
fontface = 'bold',
x = 0, size = 18,
hjust = 0) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 20))
plot_grid(title, fig3,
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1))
conif_dens <- plot_dens %>%
filter(TREAT == 0) %>%
filter(DIV == "c") %>%
ggplot(aes(x = as.factor(SITE), y = COUNT_HA)) + geom_boxplot() +
labs(x = " ",y = "Density (stem/ha)", title = "Conifer Density") +
theme(plot.title = element_text(hjust = 0)) +
scale_x_discrete(labels = c("Upland", "Lowland")) +
theme(plot.title = element_text(size = 14))
# DECID density
decid_dens <- plot_dens %>%
filter(TREAT == 0) %>%
filter(DIV == "d") %>%
ggplot(aes(x = as.factor(SITE), y = COUNT_HA)) + geom_boxplot() +
labs(x = "",y = "Density (stem/ha)", title = "Deciduous Density")  +
scale_x_discrete(labels = c("Upland", "Lowland")) +
theme(plot.title = element_text(size = 14))
density <- cowplot::plot_grid(conif_dens, decid_dens)
density
# rm(conif_dens, decid_dens)
# basal area
plot_ba <- ba %>%
group_by(SITE, TREAT, PLOT, DIV) %>%
summarise(BA_ha = mean(BA_ha))
# CONIF basal area
conif_ba <- plot_ba %>%
filter(TREAT == 0) %>%
filter(DIV == "c") %>%
ggplot(aes(x = as.factor(SITE), y = BA_ha)) + geom_boxplot() +
labs(x = " ",y = "Basal Area (m2/ha)", title = "Conifer Basal Area")   +
theme(plot.title = element_text(hjust = 0)) +
scale_x_discrete(labels = c("Upland", "Lowland")) +
theme(plot.title = element_text(size = 14))
# DECID basal area
decid_ba <-plot_ba %>%
filter(TREAT == 0) %>%
filter(DIV == "d") %>%
ggplot(aes(x = as.factor(SITE), y = BA_ha)) + geom_boxplot() +
labs(x = "",y = "Basal Area (m2/ha)", title = "Deciduous Basal Aresa")   +
scale_x_discrete(labels = c("Upland", "Lowland")) +
theme(plot.title = element_text(size = 14))
ba <- cowplot:: plot_grid(conif_ba, decid_ba, ncol = 2)
# rm(conif_ba, decid_ba)
ba
# save_plot("ba_boxplot.png", ba)
lrow <- cowplot:: plot_grid(conif_dens, conif_ba, align = "v", axis = 'l', ncol = 1)
rrow <- cowplot:: plot_grid(decid_dens, decid_ba, align = "v", axis = "l", ncol = 1)
fig3 <- cowplot:: plot_grid(lrow, rrow, ncol = 2)
fig3
title <- ggdraw() +
draw_label(
"Unburned Stand Structure between an Upland and Lowland Site",
fontface = 'bold',
x = 0, size = 18,
hjust = 0) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 20))
plot_grid(title, fig3,
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1))
plot_grid(title, fig3,
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1))
plot_grid(title, fig3,
ncol = 1,
rel_heights = c(0.1, 1))
title <- ggdraw() +
draw_label(
"Unburned Stand Structure between an Upland and Lowland Site",
fontface = 'bold',
x = 0, size = 17,
hjust = 0) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 20))
plot_grid(title, fig3,
ncol = 1,
rel_heights = c(0.1, 1))
# DECID basal area
decid_ba <-plot_ba %>%
filter(TREAT == 0) %>%
filter(DIV == "d") %>%
ggplot(aes(x = as.factor(SITE), y = BA_ha)) + geom_boxplot() +
labs(x = "",y = "Basal Area (m2/ha)", title = "Deciduous Basal Area")   +
scale_x_discrete(labels = c("Upland", "Lowland")) +
theme(plot.title = element_text(size = 14))
ba <- cowplot:: plot_grid(conif_ba, decid_ba, ncol = 2)
fig3_title <- plot_grid(title, fig3,
ncol = 1,
rel_heights = c(0.1, 1))
lrow <- cowplot:: plot_grid(conif_dens, conif_ba, align = "v", axis = 'l', ncol = 1)
rrow <- cowplot:: plot_grid(decid_dens, decid_ba, align = "v", axis = "l", ncol = 1)
fig3 <- cowplot:: plot_grid(lrow, rrow, ncol = 2)
title <- ggdraw() +
draw_label(
"Unburned Stand Structure between an Upland and Lowland Site",
fontface = 'bold',
x = 0, size = 17,
hjust = 0) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 20))
fig3_title <- plot_grid(title, fig3,
ncol = 1,
rel_heights = c(0.1, 1))
fig3_title
library(tidyverse)
library(cowplot)
library(here)
theme_set(theme_cowplot())
options(scipen = 9999)
library(tidyverse)
library(cowplot)
library(here)
theme_set(theme_cowplot())
options(scipen = 9999)
dens <- read.csv(here("data/density.csv"), stringsAsFactors = F)
dens$SITE[dens$SITE == "DALTON"] <- "Upland"
dens$SITE[dens$SITE == "STEESE"] <- "Lowland"
plot_dens <- dens %>%
group_by(SITE, TREAT, PLOT, DIV) %>%
summarise(COUNT_HA = mean(COUNT_HA))
plot_dens %>%
filter(TREAT > 0) %>%
ggplot(aes(x = as.factor(TREAT), y = COUNT_HA, fill = DIV)) +
geom_boxplot() + facet_wrap(~SITE) + ylim(0, 115000) +
labs(x = "Number of Fires", y = "Stems per Hectare",
title = "Density of Regeneration in Burned Plots") +
scale_fill_manual(values = c("#f0f0f0", "#bdbdbd"),
name = "Division",
labels = c("Conifer", "Deciduous"))
plot_dens %>%
filter(TREAT > 0) %>%
ggplot(aes(x = as.factor(TREAT), y = COUNT_HA, fill = DIV)) +
geom_boxplot() + facet_wrap(~SITE) + ylim(0, 115000) +
labs(x = "Number of Fires", y = "Density (stems/ha)",
title = "Regeneration Density in Burned Sites") +
scale_fill_manual(values = c("#f0f0f0", "#bdbdbd"),
name = "Division",
labels = c("Conifer", "Deciduous"))
plot_dens %>%
filter(TREAT > 0) %>%
ggplot(aes(x = as.factor(TREAT), y = COUNT_HA, fill = DIV)) +
geom_boxplot() + facet_wrap(~SITE) + ylim(0, 115000) +
labs(x = "Number of Fires", y = "Density (stems/ha)",
title = "Regeneration Density in an Upland and Lowland Stand across reburn history") +
scale_fill_manual(values = c("#f0f0f0", "#bdbdbd"),
name = "Division",
labels = c("Conifer", "Deciduous"))
plot_dens %>%
filter(TREAT > 0) %>%
ggplot(aes(x = as.factor(TREAT), y = COUNT_HA, fill = DIV)) +
geom_boxplot() + facet_wrap(~SITE) + ylim(0, 115000) +
labs(x = "Number of Fires", y = "Density (stems/ha)",
title = "Regeneration Density across reburn history") +
scale_fill_manual(values = c("#f0f0f0", "#bdbdbd"),
name = "Division",
labels = c("Conifer", "Deciduous"))
plot_dens %>%
filter(TREAT > 0) %>%
ggplot(aes(x = as.factor(TREAT), y = COUNT_HA, fill = DIV)) +
geom_boxplot() + facet_wrap(~SITE) + ylim(0, 115000) +
labs(x = "Number of Fires", y = "Density (stems/ha)",
title = "Regeneration Density across Reburns") +
scale_fill_manual(values = c("#f0f0f0", "#bdbdbd"),
name = "Division",
labels = c("Conifer", "Deciduous"))
plot_dens %>%
filter(TREAT > 0) %>%
ggplot(aes(x = as.factor(TREAT), y = COUNT_HA, fill = DIV)) +
geom_boxplot() + facet_wrap(~SITE) + ylim(0, 115000) +
labs(x = "Number of Fires", y = "Density (stems/ha)",
title = "Regeneration Density across Reburns") +
scale_fill_manual(values = c("#f0f0f0", "#bdbdbd"),
name = "Division",
labels = c("Conifer", "Deciduous")) +
background_grid() + plot_border()
plot_dens %>%
filter(TREAT > 0) %>%
ggplot(aes(x = as.factor(TREAT), y = COUNT_HA, fill = DIV)) +
geom_boxplot() + facet_wrap(~SITE) + ylim(0, 115000) +
labs(x = "Number of Fires", y = "Density (stems/ha)",
title = "Regeneration Density across Reburns") +
scale_fill_manual(values = c("#f0f0f0", "#bdbdbd"),
name = "Division",
labels = c("Conifer", "Deciduous")) +
background_grid() + ppanel_border()
plot_dens %>%
filter(TREAT > 0) %>%
ggplot(aes(x = as.factor(TREAT), y = COUNT_HA, fill = DIV)) +
geom_boxplot() + facet_wrap(~SITE) + ylim(0, 115000) +
labs(x = "Number of Fires", y = "Density (stems/ha)",
title = "Regeneration Density across Reburns") +
scale_fill_manual(values = c("#f0f0f0", "#bdbdbd"),
name = "Division",
labels = c("Conifer", "Deciduous")) +
background_grid() + panel_border()
# basal area figure
# fig
library(tidyverse)
library(cowplot)
library(here)
theme_set(theme_cowplot())
options(scipen = 9999)
ba <- read.csv(here("ba.csv"), stringsAsFactors = F)
